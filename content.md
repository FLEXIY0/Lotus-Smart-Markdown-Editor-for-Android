### 1. Общая концепция и основной функционал

**Цель:**  
Создать лёгкое, минималистичное приложение для создания и редактирования заметок в формате Markdown с моментальным (live) предпросмотром форматирования, поддержкой базовых элементов Markdown (заголовки, чекбоксы, ссылки, таблицы и т.д.) и дополнительными возможностями (добавление медиафайлов, распознавание речи, управление версиями).

**Основные особенности:**

- **При запуске:**
    
    - Приложение сразу открывается в режиме создания заметки.
    - Автоматическая фокусировка на главном текстовом поле, клавиатура выезжает автоматически.
    - В текстовом поле установлен placeholder для первой или пустой заметки (например, «Соберитесь с мыслями...»).
- **Редактор заметки:**
    
    - Пользователь начинает вводить текст в формате Markdown.
    - При вводе заголовка (например, «# Моя первая заметка») синтаксис Markdown обрабатывается в реальном времени:
        - Символы разметки (например, «#») становятся менее заметными (серыми), а текст форматируется как заголовок (увеличенный шрифт, изменённый цвет или стиль).
    - При переходе на новую строку, если строка начинается с Markdown‑символа, его рендеринг корректно применяется (то есть лишние символы не отображаются в предпросмотре, а текст выглядит как красиво отформатированный заголовок или абзац).
- **Нижняя панель/инструментальная панель:**
    
    - Над клавиатурой (или внизу экрана) располагается панель с несколькими круглыми кнопками:
        - **Media (Медиа):** при нажатии открывается файловый менеджер (или диалог выбора файлов) для добавления изображений, видео, аудио или голосовых сообщений. После выбора файл добавляется в заметку – либо вставляется Markdown‑ссылка, либо даже может быть предпросмотрен (лучше этот вариант).
        - **Транскрибация:** кнопка с иконкой микрофона; при её нажатии запускается механизм распознавания речи (через Google Recognizer), и преобразованный в текст результат вставляется в редактор.
        - **Контроль версий (Undo/Redo):** кнопки для отмены и повторного применения изменений. Они могут быть расположены на той же панели где и другие кнопки так или в верхней части экрана вместе с метаданными заметки.
- **Метаданные заметки (хедер):**
    
    - В верхней части экрана, над основным текстовым полем, отображаются метаданные текущей заметки:
        - **Название заметки:** берётся из первого найденного заголовка Markdown (например, из строки, начинающейся с «#»). Если заголовок не задан, по умолчанию выставляется название «Без названия», а при наличии нескольких таких заметок добавляется индекс (например, «Без названия (2)»).
        - **Дата создания и дата последнего редактирования.**
        - **Статистика:** количество слов, символов и, возможно, другие данные (например, количество ссылок, чекбоксов).
- **Хранение заметок:**
    
    - Каждая заметка сохраняется как отдельный файл с расширением `.md` в папке приложения.
    - Реализуется механизм управления за метками – в отдельной активности (или фрагменте) пользователь может просматривать список сохранённых заметок, при этом:
        - **Свайп вправо:** открывает меню/навигационную панель со списком заметок.
        Теперь в новой активности:
        - **Клик по заметке:** открывает выбранную заметку для редактирования  в 1 активности.
        - **Свайп влево:** позволяет удалить заметку.
- **Живой предпросмотр (Live preview):**
    
    - При наборе текста происходит преобразование Markdown‑содержимого в отформатированный HTML.
    - Преобразование можно выполнять на лету (с использованием библиотеки для Markdown‑парсинга, например, [CommonMark for Java](https://github.com/atlassian/commonmark-java)).
    - Результат выводится в режиме предпросмотра. Это можно реализовать:
        - как наложение/динамическое обновление внутри того же поля с использованием WebView или Jetpack Compose (например, с composable-компонентом для Markdown).
    - Обновление предпросмотра должно происходить с небольшой задержкой (debounce), чтобы не перегружать устройство при каждом символе.

---

### 2. Архитектура приложения и используемые технологии

**Инструменты и технологии:**

- **Android Studio:** основная среда разработки.
- **Язык программирования:** предпочтительно Kotlin (для современной разработки).
- **UI-фреймворк:**
    - Вы можете использовать стандартные XML‑макеты или Jetpack Compose.
    - Если выбираете Compose, то создание интерфейса будет декларативным и позволит легко организовать live preview.
- **Библиотека для парсинга Markdown:**
    - [CommonMark for Java](https://github.com/atlassian/commonmark-java) или любая другая надежная библиотека, которая поддерживает CommonMark и расширения (например, таблицы).
- **Отображение HTML:**
    - **WebView:** стандартный компонент Android для рендеринга HTML.
    - **Compose WebView:** если вы используете Jetpack Compose, можно встроить WebView через AndroidView.
    - Или использовать готовые composable‑библиотеки, такие как [MarkdownView‑Android](https://github.com/mukeshsolanki/MarkdownView-Android) для вывода отформатированного Markdown.
- **Распознавание речи:**
    - Google Recognizer для конвертации аудио в текст.
- **Хранение данных:**
    - Файловая система – каждая заметка как отдельный `.md` файл.
    - Все сохраняется в памяти приложения
    - Для списка заметок – либо стандартный список с RecyclerView (или LazyColumn в Compose), либо более продвинутая система с использованием Room, если потребуется дополнительная база данных для метаданных.
- **Модель проектирования:**
    - Рекомендуется использовать паттерн MVVM (Model-View-ViewModel) для разделения бизнес-логики, данных и интерфейса.
    - Для реактивного обновления UI можно использовать LiveData или StateFlow.